{"expireTime":9007200871875467000,"key":"transformer-remark-markdown-html-31d9c6444fd2db5ed7058b2f9e4538df-gatsby-remark-imagesgatsby-remark-external-linksgatsby-remark-prismjs-","val":"<h1>usando PassportJS en NODE</h1>\n<ul>\n<li>\n<h2>requerimientos instalacion</h2>\n</li>\n<li>\n<p>listado packages npm</p>\n<ul>\n<li>\n<pre>\npassport\npassport-google-oauth20\n</pre>\n</li>\n</ul>\n</li>\n<li>\n<p>complementos</p>\n<ul>\n<li><a href=\"http://www.passportjs.org/packages/passport-google-oauth20/\" target=\"_blank\" rel=\"nofollow\">documentacion de passportJS</a>  </li>\n</ul>\n</li>\n<li>\n<p>paso 1 en el proyecto</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i passport passport-google-oauth20</code></pre></div>\n</li>\n<li>\n<p>paso 2 en el navegador web</p>\n<ol>\n<li>ingresar a <a href=\"https://console.developers.google.com/\" target=\"_blank\" rel=\"nofollow\">Developer Console de Google</a></li>\n<li>crear PROYECTO ejemplo <strong>passportjs-practicaoauth2</strong> </li>\n<li>ingresa a <strong>Credentials</strong> y asegurate de tener seleccionado tu aplicacion</li>\n<li>ir a <strong>CONFIGURAR PANTALLA DE CONSENTIMIENTO</strong> O <strong>CONFIGURE CONSENT SCREEN</strong></li>\n<li>Marcar opciones [User type : EXTERNAL] y \"CREAR\"</li>\n<li>asignar:\na. nombre a la app <strong>passportjs-practicaoauth2</strong>\nb. correo a la app para asistencias\nc. correo del developer y \"Guardar y continuar\"</li>\n<li>Regresar a <strong>Credentials</strong> e ir a <strong>create credentials</strong> selecciona <strong>OAUTH client ID</strong>\na. selecciona tipo de aplicacion : \"aplicacion web\"\nb. nombre  <strong>passportjs-practicaoauth2</strong>\nc. URI de redireccionamiento autorizados : <strong><a href=\"http://localhost:3000/google/callback\" target=\"_blank\" rel=\"nofollow\">http://localhost:3000/google/callback</a></strong></li>\n<li>Ahora recibes tus datos de acceso!\na. tu ID CLIENTE: 416807314987-n43k7d1bqo7mbspglqsdqousk4vcfmhk.apps.googleusercontent.com\nb. tu ID secreto del CLIENTE: saXjPDAmNtVWVZfIEHxq3BRd</li>\n</ol>\n</li>\n<li>\n<p>paso 3 en el proyecto\nnew file authenticate.js en la raiz</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var passport = require(&#39;passport&#39;)\nvar GoogleStrategy = require(&#39;passport-google-oauth20&#39;).Strategy;\n// import GoogleStrategy from &quot;passport-google-oauth20&quot;;\n// const GoogleStrategy = GoogleStrategy.Strategy; \n// import passport from &quot;passport&quot;;</code></pre></div>\n</li>\n</ul>\n<p>/<em>serializacion de datos</em>/\npassport.serializeUser(function(user, done) {\ndone(null, user);\n});</p>\n<p>passport.deserializeUser(function(user, done) {\ndone(null, user);\n});\n/<em>basic configure</em>/\npassport.use(new GoogleStrategy({\nclientID: \"416807314987-n43k7d1bqo7mbspglqsdqousk4vcfmhk.apps.googleusercontent.com\",\nclientSecret: \"saXjPDAmNtVWVZfIEHxq3BRd\",\ncallbackURL: \"<a href=\"http://localhost:3000/google/callback\" target=\"_blank\" rel=\"nofollow\">http://localhost:3000/google/callback</a>\"\n},\nfunction(accessToken, refreshToken, profile, cb) {\n/<em>Usuario Registrados</em>/\nconsole.log(profile);\ncb(null,profile)</p>\n<p>  }\n));</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">en app.js importar </code></pre></div>\n<p>var passport = require('passport')// necesario</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"></code></pre></div>\n<p>/<em>revisando passport</em>/\napp.use(passport.initialize())\nrequire('./authenticate');\napp.get('/google', passport.authenticate('google', { scope: ['profile', 'email'] }));\napp.get('/google/callback', passport.authenticate('google', { failureRedirect: '/login' }), (req, res) => {\n//res.redirect('/');\nres.end('Logged in!');\n})</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">probar alguna ruta \nir a http://localhost:3000/google :D\n\n#fin</code></pre></div>"}